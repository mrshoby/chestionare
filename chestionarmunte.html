<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chestionar Munte (50)</title>
  <style>
    :root{
      --bg:#f1f3f4; --card:#ffffff; --text:#202124; --muted:#5f6368;
      --accent:#2563eb; --accent-2:#06b6d4; --danger:#d93025; --ok:#1e8e3e;
      --border:#dadce0; --shadow:0 1px 2px rgba(0,0,0,.08), 0 2px 8px rgba(0,0,0,.06);
      --radius:14px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.35;}
    .wrap{max-width:900px;margin:28px auto 64px;padding:0 14px;}
    .header{border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);background:var(--card);border:1px solid var(--border);margin-bottom:16px;}
    .topbar{height:10px;background:linear-gradient(90deg,var(--accent),var(--accent-2));}
    .head-body{padding:18px 18px 14px;}
    h1{margin:0 0 6px;font-size:22px;font-weight:750;}
    .subtitle{color:var(--muted);font-size:14px;margin:0 0 12px;}
    .meta{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;border-top:1px solid var(--border);padding:10px 18px;background:#fafafa;}
    .chip{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;color:var(--muted);font-size:13px;}
    .progress{margin-left:auto;color:var(--muted);font-size:13px;}
    .nav{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;}
    .nav a{text-decoration:none;color:var(--accent);font-weight:650;border:1px solid #e0d7f5;background:#fff;border-radius:999px;padding:6px 10px;font-size:13px;}
    .nav a:hover{background:#f6f0ff;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px 18px;margin:12px 0;}
    .q-title{font-weight:650;margin:0 0 10px;font-size:15px;}
    .q-num{color:var(--accent);font-weight:800;margin-right:6px;}
    fieldset{border:0;padding:0;margin:0;min-width:0;}
    .opt{display:flex;align-items:flex-start;gap:10px;padding:8px 10px;border-radius:10px;border:1px solid transparent;transition:background .15s ease,border .15s ease;cursor:pointer;}
    .opt:hover{background:#f6f0ff;border-color:#e7dbff;}
    input[type="radio"]{margin-top:2px;accent-color:var(--accent);transform:scale(1.05);}
    label{cursor:pointer;width:100%;}
    .missing{border-color:var(--danger)!important;box-shadow:0 0 0 3px rgba(217,48,37,.10);}
    .hint{color:var(--danger);font-size:12px;margin-top:8px;display:none;}
    .card.missing .hint{display:block;}

    /* dupÄƒ submit */
    .opt.correct{border-color: rgba(30,142,62,.35);background: rgba(30,142,62,.08);}
    .opt.wrong{border-color: rgba(217,48,37,.35);background: rgba(217,48,37,.08);}
    .answerBox{display:none;margin-top:10px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#fafafa;font-size:13px;color:var(--muted);}
    .answerBox b{color:var(--text);}

    .form-row{display:flex;gap:12px;flex-wrap:wrap;}
    .input{flex:1 1 260px;display:flex;flex-direction:column;gap:6px;}
    .input label{font-size:12px;color:var(--muted);cursor:default;}
    .input input{padding:10px 12px;border-radius:10px;border:1px solid var(--border);outline:none;font-size:14px;background:#fff;}
    .input input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(103,58,183,.12);}
    .actions{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin-top:14px;}
    .btn{border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;font-size:14px;transition:transform .05s ease,opacity .2s ease,background .2s ease;display:inline-flex;align-items:center;gap:10px;}
    .btn:active{transform:translateY(1px);}
    .btn-primary{background:var(--accent);color:#fff;}
    .btn-primary:hover{background:#5a2fb0;}
    .btn-ghost{background:#fff;color:var(--accent);border:1px solid #e0d7f5;}
    .btn-ghost:hover{background:#f6f0ff;}
    .note{color:var(--muted);font-size:13px;}
    .score{display:none;text-align:center;padding:18px;border:1px solid #d7f0dd;background:#f4fbf6;}
    .score h2{margin:6px 0 10px;font-size:20px;}
    .score .big{font-size:40px;font-weight:900;color:var(--ok);margin:0;}
    .score .small{margin:8px 0 0;color:var(--muted);font-size:13px;}
    details{margin-top:10px;color:var(--muted);font-size:13px;}
    details summary{cursor:pointer;color:var(--accent);font-weight:700;}
    .disabled{opacity:.85;pointer-events:none;user-select:none;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="topbar"></div>
      <div class="head-body">
        <h1>â›°ï¸ Chestionar: munte, drumeÈ›ie & siguranÈ›Äƒ</h1>
        <p class="subtitle">50 de Ã®ntrebÄƒri â€¢ orientare, meteo, echipament, risc â€¢ dupÄƒ â€Trimiteâ€ vezi punctajul + corecturile.</p>

        <div class="nav" aria-label="Navigare">
          <a href="index.html">ğŸ  Meniu</a>
          <a href="chestionariepuri.html">ğŸ‡ Iepuri</a>
          <a href="chestionarmunte.html">â›°ï¸ Munte</a>
          <a href="chestionariepure+munte.html">ğŸ‡â›°ï¸ Combinat</a>
        </div>

        <div class="form-row" style="margin-top:12px">
          <div class="input">
            <label for="name">Nume (opÈ›ional)</label>
            <input id="name" type="text" placeholder="Ex: Andrei Popescu" autocomplete="name" />
          </div>
          <div class="input">
            <label for="email">Email (opÈ›ional)</label>
            <input id="email" type="email" placeholder="Ex: nume@exemplu.ro" autocomplete="email" />
          </div>
        </div>
      </div>
      <div class="meta">
        <span class="chip">ğŸ“‹ Tip: grilÄƒ (o singurÄƒ variantÄƒ / Ã®ntrebare)</span>
        <span class="chip">âœ… Punctaj: 1 punct / Ã®ntrebare</span>
        <span id="progress" class="progress">Completate: 0/50</span>
      </div>
    </div>

    <div id="scoreCard" class="card score" aria-live="polite">
      <h2>Rezultat final</h2>
      <p class="big" id="scoreText">0 / 50</p>
      <p class="small">DupÄƒ â€œTrimiteâ€, ai È™i rÄƒspunsurile corecte marcate mai jos.</p>
    </div>

    <form id="quizForm" novalidate>
      <div id="questions"></div>

      <div class="card">
        <div class="actions">
          <button type="button" class="btn btn-ghost" id="resetBtn">ReseteazÄƒ (random nou)</button>
          <div class="note" id="statusNote">CompleteazÄƒ toate Ã®ntrebÄƒrile, apoi apasÄƒ â€Trimiteâ€.</div>
          <button type="submit" class="btn btn-primary" id="submitBtn">Trimite</button>
        </div>

        <details>
          <summary>Surse / ghiduri (pentru documentare)</summary>
          <ul>
            <li>National Park Service / ghiduri drumeÈ›ie È™i siguranÈ›Äƒ Ã®n naturÄƒ</li>
<li>NOAA / resurse meteo â€“ furtuni, fulgere, explicarea fronturilor</li>
<li>Leave No Trace â€“ principiile LNT pentru camping È™i trasee</li>
<li>UIAA / resurse montane â€“ echipament, riscuri, bune practici</li>
<li>Servicii de salvare montanÄƒ (ex. Salvamont) â€“ recomandÄƒri de pregÄƒtire È™i siguranÈ›Äƒ</li>
          </ul>
        </details>
      </div>
    </form>
  </div>

  <script>
    // ÃntrebÄƒrile + opÈ›iunile sunt amestecate random la fiecare Ã®ncÄƒrcare/reset.
    const QUESTIONS = [{"text":"Ce proces geologic formeazÄƒ de obicei munÈ›ii de tip â€foldâ€ (lanÈ›uri cutate)?","options":["Ciocnirea plÄƒcilor tectonice È™i compresia","Doar eroziunea vÃ¢ntului","Topirea gheÈ›arilor Ã®n mare","Impactul meteoriÈ›ilor Ã®n fiecare an"],"correct":0},{"text":"CarpaÈ›ii fac parte, Ã®n linii mari, din zona de orogenezÄƒ asociatÄƒ cu:","options":["Orogeneza alpinÄƒ (Alpine)","Orogeneza caledonianÄƒ","Orogeneza hercinicÄƒ exclusivÄƒ","Nu au legÄƒturÄƒ cu tectonica"],"correct":0},{"text":"Cel mai Ã®nalt vÃ¢rf din RomÃ¢nia este:","options":["Moldoveanu","Negoiu","Omu","ParÃ¢ngul Mare"],"correct":0},{"text":"Pe mÄƒsurÄƒ ce urci Ã®n altitudine, presiunea atmosfericÄƒ È™i oxigenul disponibil:","options":["Scad","Cresc","RÄƒmÃ¢n identice","Devine zero imediat"],"correct":0},{"text":"RÄƒul acut de altitudine apare Ã®n principal din cauza:","options":["ScÄƒderii presiunii parÈ›iale a oxigenului","CreÈ™terii zahÄƒrului din sÃ¢nge","Alergiei la soare","Lipsei totale a vÃ¢ntului"],"correct":0},{"text":"O regulÄƒ bunÄƒ pentru aclimatizare este:","options":["Urcare treptatÄƒ È™i zile de odihnÄƒ la altitudini mai mari","Urcare cÃ¢t mai rapidÄƒ fÄƒrÄƒ pauze","Somn la cea mai mare altitudine posibilÄƒ Ã®n prima zi","Evitarea apei"],"correct":0},{"text":"Ãn drumeÈ›ie, principiul celor â€3 straturiâ€ se referÄƒ la:","options":["Strat de bazÄƒ, strat izolator, strat exterior (shell)","3 perechi de È™osete groase","3 rucsacuri unul peste altul","3 sticle identice de apÄƒ"],"correct":0},{"text":"De ce este des recomandat sÄƒ eviÈ›i bumbacul la munte?","options":["ReÈ›ine umezeala È™i rÄƒceÈ™te corpul","Este prea uÈ™or","Se usucÄƒ instant","ÃncÄƒlzeÈ™te excesiv"],"correct":0},{"text":"Un semn comun de hipotermie moderatÄƒ poate include:","options":["Confuzie È™i coordonare slabÄƒ","Piele foarte roÈ™ie de la cÄƒldurÄƒ","Vedere perfectÄƒ","Sete zero"],"correct":0},{"text":"â€Wind chillâ€ descrie:","options":["Efectul vÃ¢ntului care creÈ™te pierderea de cÄƒldurÄƒ È™i senzaÈ›ia de frig","Cantitatea de UV din aer","NumÄƒrul de nori","Nivelul de oxigen"],"correct":0},{"text":"Ãn general, distanÈ›a dintre curbele de nivel pe hartÄƒ aratÄƒ:","options":["Panta: curbe apropiate = abrupt","Altitudinea exactÄƒ a vÃ¢rfului","Tipul de rocÄƒ","DirecÈ›ia vÃ¢ntului"],"correct":0},{"text":"Ce instrument rÄƒmÃ¢ne util pentru orientare chiar È™i fÄƒrÄƒ semnal GSM?","options":["Harta tipÄƒritÄƒ + busola","Doar aplicaÈ›ia de social media","Bluetooth speaker","CamerÄƒ foto"],"correct":0},{"text":"CÃ¢nd foloseÈ™ti o busolÄƒ, trebuie sÄƒ È›ii cont de:","options":["Devierea/declinaÈ›ia magneticÄƒ (unde e relevant)","Culoarea rucsacului","Tipul de È™ireturi","Lungimea beÈ›elor"],"correct":0},{"text":"O regulÄƒ simplÄƒ pentru furtuni cu descÄƒrcÄƒri electrice este â€30-30â€:","options":["DacÄƒ vezi fulger È™i auzi tunet sub 30 sec, cautÄƒ adÄƒpost; aÈ™teaptÄƒ 30 min dupÄƒ ultimul tunet","Stai 30 minute Ã®n apÄƒ","Allegi 30 pietre","UrcÄƒ 30 metri mai sus"],"correct":0},{"text":"Ãn timpul unei furtuni cu fulgere, locurile cele mai periculoase includ:","options":["Creste expuse È™i copaci izolaÈ›i","PÄƒdure deasÄƒ uniformÄƒ","VÄƒi largi joase","Ãn interiorul unei clÄƒdiri"],"correct":0},{"text":"Cumulus care cresc rapid È™i se Ã®nchid la culoare pot indica:","options":["Dezvoltare de furtunÄƒ","Stabilitate totalÄƒ","Vreme garantat seninÄƒ 2 zile","ScÄƒdere de altitudine"],"correct":0},{"text":"Nori lenticulari (Ã®n formÄƒ de â€lentilÄƒâ€) sugereazÄƒ adesea:","options":["VÃ¢nt puternic la altitudine È™i turbulenÈ›e","PlajÄƒ aproape","Calm total","Nicio legÄƒturÄƒ cu vÃ¢ntul"],"correct":0},{"text":"O scÄƒdere rapidÄƒ a presiunii barometrice poate semnala:","options":["Apropierea unui front È™i vreme mai rea","Vreme identicÄƒ 7 zile","CreÈ™tere instantÄƒ a temperaturii nocturne","ZÄƒpadÄƒ doar vara"],"correct":0},{"text":"â€Turn-around timeâ€ Ã®n drumeÈ›ie Ã®nseamnÄƒ:","options":["Ora limitÄƒ la care te Ã®ntorci indiferent de progres","Momentul cÃ¢nd schimbi bocancii","Ora la care Ã®ncepi sÄƒ mÄƒnÃ¢nci","CÃ¢nd faci poze"],"correct":0},{"text":"â€Cele 10 esenÈ›ialeâ€ (10 essentials) includ, Ã®n mod tipic:","options":["NavigaÈ›ie, iluminare, trusÄƒ prim ajutor, protecÈ›ie meteo etc.","ConsolÄƒ de jocuri, parfum, 3 tricouri","Doar apÄƒ È™i nimic altceva","Doar telefonul"],"correct":0},{"text":"Un semn comun de deshidratare este:","options":["Urina Ã®nchisÄƒ la culoare È™i obosealÄƒ","SomnolenÈ›Äƒ doar dupÄƒ masÄƒ","PÄƒr lucios","TemperaturÄƒ constantÄƒ"],"correct":0},{"text":"Metoda sigurÄƒ de a face apÄƒ potabilÄƒ dintr-un izvor necunoscut poate fi:","options":["Filtrare/sterilizare sau fierbere","Doar mirosirea apei","AdÄƒugarea de sare","Agitarea sticlei"],"correct":0},{"text":"Ãn traversarea unui rÃ¢u rece/rapid, o practicÄƒ de siguranÈ›Äƒ este:","options":["SÄƒ desfaci centura de È™old a rucsacului (È™i, dupÄƒ caz, chinga de piept)","SÄƒ sari cu ochii Ã®nchiÈ™i","SÄƒ traversezi singur noaptea","SÄƒ cari pietre Ã®n braÈ›e"],"correct":0},{"text":"Ãn iarnÄƒ, riscul de avalanÈ™Äƒ este adesea mai mare pe pante de aproximativ:","options":["30â€“45Â°","0â€“5Â°","60â€“80Â° mereu","Orice pantÄƒ platÄƒ"],"correct":0},{"text":"Ãn teren Ã®nzÄƒpezit, un factor important Ã®n evaluarea avalanÈ™ei este:","options":["Stratificarea È™i stabilitatea stratului de zÄƒpadÄƒ","Culoarea rucsacului","NumÄƒrul de selfie-uri","Marca bocancilor"],"correct":0},{"text":"O vale glaciarÄƒ tipicÄƒ are profil:","options":["Ãn U","Ãn V","PÄƒtrat perfect","Circular"],"correct":0},{"text":"O vale formatÄƒ predominant de un rÃ¢u are adesea profil:","options":["Ãn V","Ãn U","Ãn W","Ãn cerc"],"correct":0},{"text":"Talus/scree se referÄƒ la:","options":["GrohotiÈ™/pietre instabile la baza versantului","Lac de munte","PÄƒdure tropicalÄƒ","GheaÈ›Äƒ subÈ›ire pe rÃ¢u"],"correct":0},{"text":"Care accesoriu ajutÄƒ la reducerea oboselii pe coborÃ¢ri lungi?","options":["BeÈ›e de trekking","Ochelari de soare pe ceafÄƒ","CÄƒciulÄƒ foarte groasÄƒ vara","Un claxon"],"correct":0},{"text":"Ãn caz cÄƒ te rÄƒtÄƒceÈ™ti, metoda â€STOPâ€ Ã®nseamnÄƒ (Ã®n esenÈ›Äƒ):","options":["Stop, Think, Observe, Plan","Sari, Treci, OcoleÈ™te, PleacÄƒ","StrigÄƒ, Trage, OpreÈ™te, PorneÈ™te","Stai, Taci, OboseÈ™te, PlÃ¢nge"],"correct":0},{"text":"Bateriile telefonului se consumÄƒ mai repede la frig deoarece:","options":["Capacitatea bateriei scade la temperaturi joase","Semnalul devine infinit","Ecranul devine mai mare","GPS-ul nu mai existÄƒ"],"correct":0},{"text":"O practicÄƒ utilÄƒ pentru a economisi bateria telefonului pe munte este:","options":["Mod avion + GPS doar la nevoie / power bank","Luminozitate maximÄƒ permanent","Streaming video continuu","Èšinut Ã®n zÄƒpadÄƒ"],"correct":0},{"text":"Ãn general, radiaÈ›ia UV la altitudine:","options":["Este mai puternicÄƒ, deci protecÈ›ia solarÄƒ conteazÄƒ","Este mereu zero","Depinde doar de pantofi","Nu afecteazÄƒ pielea"],"correct":0},{"text":"Ãn managementul riscului, â€planul Bâ€ Ã®ntr-o turÄƒ Ã®nseamnÄƒ:","options":["RutÄƒ alternativÄƒ/Ã®ntoarcere Ã®n caz de vreme sau timp limitat","ÃncÄƒ un munte mai mare obligatoriu","SÄƒ ignori prognoza","SÄƒ pleci fÄƒrÄƒ apÄƒ"],"correct":0},{"text":"Un semnal internaÈ›ional de ajutor cu fluierul este adesea:","options":["3 sunete scurte repetate","1 sunet lung o datÄƒ","2 sunete È™i gata","Orice numÄƒr la Ã®ntÃ¢mplare"],"correct":0},{"text":"Ãn camping, o recomandare Leave No Trace este sÄƒ campezi la aproximativ:","options":["60 m (200 ft) de surse de apÄƒ","1 m de rÃ¢u","Direct Ã®n albie","Ãn mijlocul potecii"],"correct":0},{"text":"Leave No Trace recomandÄƒ, Ã®n general, sÄƒ:","options":["Ãmpachetezi È™i sÄƒ iei gunoiul cu tine","Ãngropi plasticul","Arunci resturi Ã®n lac","Dai foc ambalajelor oriunde"],"correct":0},{"text":"Ãn zone cu faunÄƒ mare, depozitarea mÃ¢ncÄƒrii se face ideal:","options":["Ãn recipient rezistent/loc sigur, departe de cort","Ãn cort lÃ¢ngÄƒ sacul de dormit","La intrarea Ã®n potecÄƒ","Pe jos, lÃ¢ngÄƒ apÄƒ"],"correct":0},{"text":"Un semn timpuriu de degerÄƒturÄƒ poate fi:","options":["AmorÈ›ealÄƒ È™i piele palidÄƒ/ceratÄƒ","FebrÄƒ mare instant","Miros puternic de fum","Durere de dinÈ›i"],"correct":0},{"text":"CÃ¢nd cobori o pantÄƒ foarte abruptÄƒ, un principiu util este:","options":["PaÈ™i scurÈ›i È™i control, atenÈ›ie la centrul de greutate","Alergi cÃ¢t poÈ›i","Te laÈ™i pe spate excesiv","Ãnchizi ochii"],"correct":0},{"text":"Microspikes/crampoane uÈ™oare sunt folosite mai ales pentru:","options":["AderenÈ›Äƒ pe gheaÈ›Äƒ/zÄƒpadÄƒ bÄƒtÄƒtoritÄƒ","Ãnot","Orientare astronomicÄƒ","GÄƒtit"],"correct":0},{"text":"Cramponii clasici sunt mai potriviÈ›i decÃ¢t microspikes cÃ¢nd:","options":["Ai gheaÈ›Äƒ durÄƒ È™i pante mai serioase","E doar noroi","E asfalt","E plajÄƒ"],"correct":0},{"text":"Un motiv pentru care e periculos sÄƒ stai pe creastÄƒ Ã®n furtunÄƒ este:","options":["EÈ™ti mai expus la fulgere È™i vÃ¢nt","Aerul e mai dulce","Ai semnal mai bun","E mai cald"],"correct":0},{"text":"O practicÄƒ responsabilÄƒ Ã®nainte de turÄƒ este:","options":["SÄƒ laÈ™i cuiva ruta È™i ora estimatÄƒ de Ã®ntoarcere","SÄƒ nu spui nimÄƒnui nimic","SÄƒ pleci fÄƒrÄƒ hartÄƒ","SÄƒ mergi fÄƒrÄƒ Ã®ncÄƒrcÄƒtor"],"correct":0},{"text":"Ãn caz de urgenÈ›Äƒ Ã®n RomÃ¢nia, numÄƒrul unic este:","options":["112","911","999","110"],"correct":0},{"text":"Un risc comun pe timp de varÄƒ la altitudine include:","options":["Furtuni rapide de dupÄƒ-amiazÄƒ","AvalanÈ™e zilnice obligatorii","Lipsa totalÄƒ a UV","Risc zero de deshidratare"],"correct":0},{"text":"Un element cheie pentru prevenirea bÄƒtÄƒturilor este:","options":["È˜osete potrivite + bocanci corect adaptaÈ›i + opriri la timp","StrÃ¢ngi la maxim È™ireturile mereu","Mergi ud tot timpul","Ignori orice disconfort"],"correct":0},{"text":"Ce Ã®nseamnÄƒ, Ã®n practicÄƒ, â€mergi pe potecÄƒâ€ Ã®n arii sensibile?","options":["Reducerea eroziunii È™i protejarea vegetaÈ›iei","Doar ca sÄƒ fie mai frumos Ã®n poze","Ca sÄƒ nu Ã®È›i murdÄƒreÈ™ti bocancii","Nu are legÄƒturÄƒ cu mediul"],"correct":0},{"text":"Un indiciu cÄƒ temperatura va scÄƒdea la apus este:","options":["RadiaÈ›ie nocturnÄƒ + vÃ¢nt, mai ales pe creste","Soare puternic la prÃ¢nz","Culoarea rucsacului","NumÄƒrul de paÈ™i"],"correct":0},{"text":"DacÄƒ apare durere de cap + greaÈ›Äƒ la altitudine, o mÄƒsurÄƒ prudentÄƒ este:","options":["Oprire, hidratare È™i, dacÄƒ simptomele persistÄƒ, coborÃ¢re","SÄƒ urci mai repede","SÄƒ eviÈ›i apa","SÄƒ dormi pe vÃ¢rf imediat"],"correct":0}];

    // === RANDOM puternic (crypto) ===
    function randInt(maxExclusive) {
      if (maxExclusive <= 0) return 0;
      const cryptoObj = window.crypto || window.msCrypto;
      if (!cryptoObj || !cryptoObj.getRandomValues) {
        return Math.floor(Math.random() * maxExclusive);
      }
      const range = 0x100000000; // 2^32
      const limit = range - (range % maxExclusive);
      const buf = new Uint32Array(1);
      let x;
      do {
        cryptoObj.getRandomValues(buf);
        x = buf[0];
      } while (x >= limit);
      return x % maxExclusive;
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = randInt(i + 1);
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function escapeHtml(s) {
      return String(s).replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[c]));
    }

    const state = { rendered: [], answeredCount: 0, submitted: false, total: 50 };

    const elQuestions = document.getElementById("questions");
    const elProgress = document.getElementById("progress");
    const elScoreCard = document.getElementById("scoreCard");
    const elScoreText = document.getElementById("scoreText");
    const form = document.getElementById("quizForm");
    const resetBtn = document.getElementById("resetBtn");

    function updateProgress() {
      elProgress.textContent = `Completate: ${state.answeredCount}/${state.total}`;
    }

    function countAnswered() {
      let c = 0;
      state.rendered.forEach((_, idx) => {
        if (form.querySelector(`input[name="q_${idx}"]:checked`)) c++;
      });
      state.answeredCount = c;
      updateProgress();
    }

    function clearMissingMarks() {
      document.querySelectorAll(".card.missing").forEach(c => c.classList.remove("missing"));
    }

    // 1) shuffle Ã®ntrebÄƒri
    // 2) shuffle opÈ›iuni per Ã®ntrebare
    // 3) corectul se pÄƒstreazÄƒ prin flag isCorrect
    function buildRenderedQuestions() {
      const qList = QUESTIONS.map(q => {
        const opts = q.options.map((t, i) => ({ text: t, isCorrect: i === q.correct }));
        shuffle(opts);
        const correctIndex = opts.findIndex(o => o.isCorrect);
        return { text: q.text, options: opts, correctIndex };
      });
      shuffle(qList);
      return qList;
    }

    function render() {
      elQuestions.innerHTML = "";
      state.rendered = buildRenderedQuestions();
      state.total = state.rendered.length;

      state.rendered.forEach((item, idx) => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.qIndex = idx;

        const title = document.createElement("p");
        title.className = "q-title";
        title.innerHTML = `<span class="q-num">${idx + 1}.</span> ${escapeHtml(item.text)}`;
        card.appendChild(title);

        const fs = document.createElement("fieldset");
        fs.setAttribute("role","radiogroup");

        item.options.forEach((opt, oIdx) => {
          const optId = `q_${idx}_opt_${oIdx}`;

          const wrap = document.createElement("div");
          wrap.className = "opt";
          wrap.dataset.optIndex = String(oIdx);

          const radio = document.createElement("input");
          radio.type = "radio";
          radio.name = `q_${idx}`;
          radio.id = optId;
          radio.value = String(oIdx);

          radio.addEventListener("change", () => {
            if (state.submitted) return;
            card.classList.remove("missing");
            countAnswered();
          });

          const label = document.createElement("label");
          label.setAttribute("for", optId);
          label.textContent = opt.text;

          wrap.appendChild(radio);
          wrap.appendChild(label);
          fs.appendChild(wrap);
        });

        const hint = document.createElement("div");
        hint.className = "hint";
        hint.textContent = "Ãntrebare obligatorie (alege o variantÄƒ).";

        const answerBox = document.createElement("div");
        answerBox.className = "answerBox";
        answerBox.id = `answer_${idx}`;

        card.appendChild(fs);
        card.appendChild(hint);
        card.appendChild(answerBox);
        elQuestions.appendChild(card);
      });

      state.answeredCount = 0;
      updateProgress();
    }

    function validateAllAnswered() {
      clearMissingMarks();
      let firstMissing = null;

      state.rendered.forEach((_, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        if (!checked) {
          const card = form.querySelector(`.card[data-q-index="${idx}"]`);
          if (card) card.classList.add("missing");
          if (!firstMissing) firstMissing = card;
        }
      });

      if (firstMissing) {
        firstMissing.scrollIntoView({behavior:"smooth", block:"center"});
        return false;
      }
      return true;
    }

    function computeScore() {
      let score = 0;
      state.rendered.forEach((item, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        const chosen = checked ? Number(checked.value) : -1;
        if (chosen === item.correctIndex) score++;
      });
      return score;
    }

    function showCorrectAnswers() {
      state.rendered.forEach((item, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        const chosen = checked ? Number(checked.value) : -1;

        const card = form.querySelector(`.card[data-q-index="${idx}"]`);
        if (!card) return;

        const opts = card.querySelectorAll(".opt");
        opts.forEach(optEl => {
          const oIdx = Number(optEl.dataset.optIndex);
          optEl.classList.remove("correct","wrong");
          if (oIdx === item.correctIndex) optEl.classList.add("correct");
          if (chosen !== item.correctIndex && oIdx === chosen) optEl.classList.add("wrong");
        });

        const correctText = item.options[item.correctIndex]?.text ?? "";
        const chosenText = (chosen >= 0 && item.options[chosen]) ? item.options[chosen].text : "â€”";

        const box = document.getElementById(`answer_${idx}`);
        if (box) {
          box.innerHTML =
            `<div><b>RÄƒspuns corect:</b> ${escapeHtml(correctText)}</div>` +
            `<div style="margin-top:6px"><b>RÄƒspunsul tÄƒu:</b> ${escapeHtml(chosenText)}</div>`;
          box.style.display = "block";
        }
      });
    }

    function lockForm() {
      state.submitted = true;
      form.querySelectorAll("input, button").forEach(el => {
        if (el.id === "resetBtn") return;
        el.disabled = true;
      });
      document.getElementById("questions").classList.add("disabled");
    }

    function unlockAndReset() {
      state.submitted = false;
      form.querySelectorAll("input, button").forEach(el => el.disabled = false);
      document.getElementById("questions").classList.remove("disabled");
      elScoreCard.style.display = "none";
      clearMissingMarks();
      render(); // random nou
      window.scrollTo({top:0, behavior:"smooth"});
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      if (state.submitted) return;

      if (!validateAllAnswered()) return;

      const score = computeScore();
      const total = state.total;

      elScoreText.textContent = `${score} / ${total}`;
      elScoreCard.style.display = "block";

      showCorrectAnswers();
      lockForm();
      elScoreCard.scrollIntoView({behavior:"smooth", block:"center"});
    });

    resetBtn.addEventListener("click", () => unlockAndReset());

    render();
  </script>
</body>
</html>
