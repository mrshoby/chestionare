<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chestionar: Iepuri Ã®n naturÄƒ & vÃ¢nÄƒtoare (50 Ã®ntrebÄƒri)</title>
  <style>
    :root{
      --bg:#f1f3f4; --card:#ffffff; --text:#202124; --muted:#5f6368;
      --accent:#673ab7; --accent-2:#7e57c2; --danger:#d93025; --ok:#1e8e3e;
      --border:#dadce0; --shadow:0 1px 2px rgba(0,0,0,.08), 0 2px 8px rgba(0,0,0,.06);
      --radius:14px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.35;}
    .wrap{max-width:860px;margin:28px auto 64px;padding:0 14px;}
    .header{border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);background:var(--card);border:1px solid var(--border);margin-bottom:16px;}
    .topbar{height:10px;background:linear-gradient(90deg,var(--accent),var(--accent-2));}
    .head-body{padding:18px 18px 14px;}
    h1{margin:0 0 6px;font-size:22px;font-weight:700;}
    .subtitle{color:var(--muted);font-size:14px;margin:0 0 12px;}
    .meta{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;border-top:1px solid var(--border);padding:10px 18px;background:#fafafa;}
    .chip{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;color:var(--muted);font-size:13px;}
    .progress{margin-left:auto;color:var(--muted);font-size:13px;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px 18px;margin:12px 0;}
    .q-title{font-weight:650;margin:0 0 10px;font-size:15px;}
    .q-num{color:var(--accent);font-weight:700;margin-right:6px;}
    fieldset{border:0;padding:0;margin:0;min-width:0;}
    .opt{display:flex;align-items:flex-start;gap:10px;padding:8px 10px;border-radius:10px;border:1px solid transparent;transition:background .15s ease,border .15s ease;cursor:pointer;}
    .opt:hover{background:#f6f0ff;border-color:#e7dbff;}
    input[type="radio"]{margin-top:2px;accent-color:var(--accent);transform:scale(1.05);}
    label{cursor:pointer;width:100%;}
    .missing{border-color:var(--danger)!important;box-shadow:0 0 0 3px rgba(217,48,37,.10);}
    .hint{color:var(--danger);font-size:12px;margin-top:8px;display:none;}
    .card.missing .hint{display:block;}

    /* dupÄƒ submit */
    .opt.correct{border-color: rgba(30,142,62,.35);background: rgba(30,142,62,.08);}
    .opt.wrong{border-color: rgba(217,48,37,.35);background: rgba(217,48,37,.08);}
    .answerBox{display:none;margin-top:10px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#fafafa;font-size:13px;color:var(--muted);}
    .answerBox b{color:var(--text);}

    .form-row{display:flex;gap:12px;flex-wrap:wrap;}
    .input{flex:1 1 260px;display:flex;flex-direction:column;gap:6px;}
    .input label{font-size:12px;color:var(--muted);cursor:default;}
    .input input{padding:10px 12px;border-radius:10px;border:1px solid var(--border);outline:none;font-size:14px;background:#fff;}
    .input input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(103,58,183,.12);}
    .actions{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin-top:14px;}
    .btn{border:0;border-radius:12px;padding:10px 14px;font-weight:650;cursor:pointer;font-size:14px;transition:transform .05s ease,opacity .2s ease,background .2s ease;display:inline-flex;align-items:center;gap:10px;}
    .btn:active{transform:translateY(1px);}
    .btn-primary{background:var(--accent);color:#fff;}
    .btn-primary:hover{background:#5a2fb0;}
    .btn-ghost{background:#fff;color:var(--accent);border:1px solid #e0d7f5;}
    .btn-ghost:hover{background:#f6f0ff;}
    .note{color:var(--muted);font-size:13px;}
    .score{display:none;text-align:center;padding:18px;border:1px solid #d7f0dd;background:#f4fbf6;}
    .score h2{margin:6px 0 10px;font-size:20px;}
    .score .big{font-size:40px;font-weight:800;color:var(--ok);margin:0;}
    .score .small{margin:8px 0 0;color:var(--muted);font-size:13px;}
    .disabled{opacity:.85;pointer-events:none;user-select:none;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="topbar"></div>
      <div class="head-body">
        <h1>Chestionar: iepuri Ã®n naturÄƒ & vÃ¢nÄƒtoare responsabilÄƒ</h1>
        <p class="subtitle">50 de Ã®ntrebÄƒri. DupÄƒ â€œTrimiteâ€ vezi punctajul + rÄƒspunsurile corecte. ÃntrebÄƒrile È™i opÈ›iunile sunt random la fiecare Ã®ncÄƒrcare/reset.</p>

        <div class="form-row" style="margin-top:12px">
          <div class="input">
            <label for="name">Nume (opÈ›ional)</label>
            <input id="name" type="text" placeholder="Ex: Andrei Popescu" autocomplete="name" />
          </div>
          <div class="input">
            <label for="email">Email (opÈ›ional)</label>
            <input id="email" type="email" placeholder="Ex: nume@exemplu.ro" autocomplete="email" />
          </div>
        </div>
      </div>
      <div class="meta">
        <span class="chip">ğŸ“‹ Tip: grilÄƒ (o singurÄƒ variantÄƒ / Ã®ntrebare)</span>
        <span class="chip">âœ… Punctaj: 1 punct / Ã®ntrebare</span>
        <span id="progress" class="progress">Completate: 0/50</span>
      </div>
    </div>

    <div id="scoreCard" class="card score" aria-live="polite">
      <h2>Rezultat final</h2>
      <p class="big" id="scoreText">0 / 50</p>
      <p class="small">Mai jos sunt marcate È™i rÄƒspunsurile corecte.</p>
    </div>

    <form id="quizForm" novalidate>
      <div id="questions"></div>

      <div class="card">
        <div class="actions">
          <button type="button" class="btn btn-ghost" id="resetBtn">ReseteazÄƒ (random nou)</button>
          <div class="note" id="statusNote">CompleteazÄƒ toate Ã®ntrebÄƒrile, apoi apasÄƒ â€Trimiteâ€.</div>
          <button type="submit" class="btn btn-primary" id="submitBtn">Trimite</button>
        </div>
      </div>
    </form>
  </div>

  <script>
    const QUESTIONS = [
      { text: "Iepurele de cÃ¢mp (Lepus europaeus) se odihneÈ™te frecvent ziua Ã®ntr-o:", options: ["Vizuina sÄƒpatÄƒ adÃ¢nc (warren)", "Scorbura unui copac", "VizuinÄƒ Ã®mprumutatÄƒ de la vulpe", "Depresiune superficialÄƒ Ã®n sol/iarbÄƒ (â€formÄƒâ€)"], correct: 3 },
      { text: "Iepurele european (Oryctolagus cuniculus) este cunoscut pentru:", options: ["ViaÈ›Äƒ exclusiv Ã®n copaci", "SÄƒparea reÈ›elelor de vizuini (â€warrensâ€)", "Ãnot constant Ã®n lacuri", "Hibernare iarna"], correct: 1 },
      { text: "Care dintre cele douÄƒ este mai renumit pentru viaÈ›a socialÄƒ Ã®n colonii È™i folosirea comunÄƒ a vizuinilor?", options: ["Iepurele european (Oryctolagus cuniculus)", "Iepurele de cÃ¢mp (Lepus europaeus)", "Ambele identic", "Niciuna"], correct: 0 },
      { text: "Cum sunt, Ã®n general, puii de iepure de cÃ¢mp (leverets) la naÈ™tere?", options: ["Orbi È™i fÄƒrÄƒ blanÄƒ", "Cu ochii deschiÈ™i È™i cu blanÄƒ", "NÄƒscuÈ›i Ã®n apÄƒ", "EclozeazÄƒ din ouÄƒ"], correct: 1 },
      { text: "Cum sunt, Ã®n general, puii de iepure (kittens) la naÈ™tere?", options: ["Cu ochii deschiÈ™i È™i alergÃ¢nd imediat", "Orbi È™i aproape fÄƒrÄƒ blanÄƒ, Ã®n cuib/vizuinÄƒ", "NÄƒscuÈ›i Ã®n copaci", "IndependenÈ›i din prima zi"], correct: 1 },
      { text: "Habitatul tipic pentru iepurele de cÃ¢mp (Lepus europaeus) este adesea:", options: ["PÄƒduri foarte dese", "CÃ¢mpuri deschise/pÄƒÈ™uni, adesea lÃ¢ngÄƒ garduri vii È™i liziere", "PeÈ™teri montane", "Zone exclusiv urbane"], correct: 1 },
      { text: "Un habitat frecvent preferat de iepurele european pentru a-È™i sÄƒpa vizuini include:", options: ["Sol moale/nisipos È™i zone relativ uscate", "StÃ¢ncÄƒ masivÄƒ fÄƒrÄƒ sol", "PajiÈ™ti mlÄƒÈ™tinoase permanente", "GheÈ›ari"], correct: 0 },
      { text: "Ãn general, iepurii È™i iepurii de cÃ¢mp tind sÄƒ fie mai activi:", options: ["La prÃ¢nz, Ã®n plin soare", "Mai ales seara/noaptea (crepuscular/nocturn)", "Doar iarna", "Doar Ã®n timpul furtunilor"], correct: 1 },
      { text: "Dieta lor Ã®n naturÄƒ este Ã®n principal:", options: ["CarnivorÄƒ", "HerbivorÄƒ (ierburi, plante, frunze)", "Exclusiv insectivorÄƒ", "Exclusiv piscivorÄƒ"], correct: 1 },
      { text: "Iarna, iepurele de cÃ¢mp poate completa dieta cu:", options: ["Carne de mici mamifere", "CrenguÈ›e, muguri È™i scoarÈ›Äƒ", "Numai fructe tropicale", "Doar seminÈ›e de floarea-soarelui"], correct: 1 },
      { text: "O strategie comunÄƒ de apÄƒrare a iepurelui european Ã®mpotriva prÄƒdÄƒtorilor este:", options: ["SÄƒ se ascundÄƒ Ã®n vizuini È™i sÄƒ fugÄƒ spre acoperire", "SÄƒ atace Ã®n haitÄƒ", "SÄƒ se camufleze schimbÃ¢nd culoarea pielii instant", "SÄƒ rÄƒmÃ¢nÄƒ nemiÈ™cat Ã®n apÄƒ"], correct: 0 },
      { text: "Ce adaptare ajutÄƒ iepurele de cÃ¢mp sÄƒ scape Ã®n teren deschis?", options: ["Picioare lungi È™i alergare rapidÄƒ de anduranÈ›Äƒ", "Gheare pentru cÄƒÈ›Äƒrat", "Aripi", "BlanÄƒ impermeabilÄƒ pentru scufundÄƒri"], correct: 0 },
      { text: "Un indiciu de identificare frecvent pentru iepurele de cÃ¢mp este:", options: ["Urechi fÄƒrÄƒ vÃ¢rfuri Ã®ntunecate", "Urechi mai scurte decÃ¢t capul", "VÃ¢rfuri negre la urechi (la multe populaÈ›ii)", "Coarne"], correct: 2 },
      { text: "De ce sunt vizuinile (â€warrensâ€) importante pentru iepuri?", options: ["Pentru cÄƒ produc hranÄƒ", "Ca adÄƒpost contra prÄƒdÄƒtorilor È™i pentru creÈ™terea puilor", "Pentru cÄƒ Ã®ncÄƒlzesc aerul", "Pentru cÄƒ Ã®nlocuiesc apa"], correct: 1 },
      { text: "Comportamentul numit â€boxingâ€, observat la iepurele de cÃ¢mp primÄƒvara, este asociat cel mai des cu:", options: ["Hibernarea", "InteracÈ›iuni din sezonul de reproducere (alergÄƒri, competiÈ›ie)", "Construirea vizuinilor", "Ãnotul"], correct: 1 },

      { text: "Ãn tiparul urmelor de iepure/iepure de cÃ¢mp Ã®n zÄƒpadÄƒ, de regulÄƒ:", options: ["Urmele din spate rÄƒmÃ¢n mereu Ã®n spatele celor din faÈ›Äƒ", "Urmele din spate cad Ã®naintea celor din faÈ›Äƒ (salt/leapfrog)", "Se vede mereu o urmÄƒ de coadÄƒ", "Apar doar 2 urme per sÄƒriturÄƒ"], correct: 1 },
      { text: "Un set tipic de urme de iepure/iepure de cÃ¢mp la deplasare (salt) apare adesea ca:", options: ["4 amprente (2 faÈ›Äƒ + 2 spate)", "1 amprentÄƒ mare", "6 amprente fixe", "Doar urme de coadÄƒ"], correct: 0 },
      { text: "Excrementele de iepure european sunt, de obicei:", options: ["Fire lungi ca la vulpe", "PeleÈ›i mici, adesea sub 1 cm", "Lichide fÄƒrÄƒ formÄƒ", "BucÄƒÈ›i mari ovale de 5 cm"], correct: 1 },
      { text: "Dauna tipicÄƒ de iepure pe lÄƒstari tineri/vegetatie poate fi recunoscutÄƒ prin:", options: ["Rupere zdrenÈ›uitÄƒ", "TÄƒieturÄƒ curatÄƒ, adesea Ã®n unghi", "Arsuri pe scoarÈ›Äƒ", "GÄƒuri perfect circulare"], correct: 1 },
      { text: "O diferenÈ›Äƒ folositÄƒ des pentru a distinge dauna de iepure faÈ›Äƒ de cea de cerb este cÄƒ iepurele:", options: ["Taie mai curat, cerbul rupe mai neregulat", "LasÄƒ Ã®ntotdeauna urme de dinÈ›i pe metal", "MÄƒnÃ¢ncÄƒ doar frunze uscate", "Nu produce niciodatÄƒ urme"], correct: 0 },
      { text: "Un indiciu cÄƒ o zonÄƒ este folositÄƒ frecvent de iepuri poate fi:", options: ["AbsenÈ›a totalÄƒ a vegetaÈ›iei", "Latrine cu peleÈ›i È™i intrÄƒri de vizuinÄƒ Ã®n apropiere", "Doar pene de pasÄƒre", "Doar urme de copite"], correct: 1 },
      { text: "â€Formaâ€ (form) la iepurele de cÃ¢mp este cel mai corect descrisÄƒ ca:", options: ["Un tunel adÃ¢nc de 20 m", "Un cuib Ã®n copac", "O depresiune superficialÄƒ unde se culcÄƒ È™i se camufleazÄƒ", "O vizuinÄƒ sub apÄƒ"], correct: 2 },
      { text: "Ãn general, care urme tind sÄƒ fie mai mari Ã®n setul de urme (salt)?", options: ["Cele din faÈ›Äƒ", "Cele din spate", "Sunt identice", "Nu se pot compara"], correct: 1 },
      { text: "DacÄƒ gÄƒseÈ™ti multe peleÈ›i Ã®mprÄƒÈ™tiaÈ›i È™i tÄƒieturi proaspete pe vegetaÈ›ie, o interpretare rezonabilÄƒ este:", options: ["Activitate recentÄƒ de hrÄƒnire Ã®n zonÄƒ", "PrezenÈ›Äƒ sigurÄƒ de lup", "Cutremur recent", "Nu spune nimic"], correct: 0 },
      { text: "Urmele sunt cel mai uÈ™or de observat pentru iepuri/iepuri de cÃ¢mp, de obicei, Ã®n:", options: ["ZÄƒpadÄƒ sau noroi umed", "Asfalt uscat", "Aer", "ApÄƒ limpede"], correct: 0 },

      { text: "Myxomatosis este o boalÄƒ cauzatÄƒ de:", options: ["Un parazit intestinal", "Myxoma virus (poxvirus)", "O ciupercÄƒ de pÄƒdure", "Deficit de vitamine"], correct: 1 },
      { text: "Rabbit haemorrhagic disease (RHD) este cauzatÄƒ de:", options: ["Calicivirus (Lagovirus)", "Bacterie din sol", "Viermi intestinali", "Polen"], correct: 0 },
      { text: "Iepurii È™i iepurii de cÃ¢mp sunt, Ã®n mod tipic, pradÄƒ pentru:", options: ["Vulpi È™i pÄƒsÄƒri rÄƒpitoare (printre altele)", "Doar peÈ™ti", "Doar insecte", "Nimeni"], correct: 0 },
      { text: "RSPCA menÈ›ioneazÄƒ cÄƒ levereÈ›ii (puii de iepure de cÃ¢mp) pot fi gÄƒsiÈ›i singuri deoarece:", options: ["Sunt abandonaÈ›i definitiv", "Mama Ã®i lasÄƒ ascunÈ™i È™i revine sÄƒ Ã®i hrÄƒneascÄƒ", "Se hrÄƒnesc singuri din prima orÄƒ", "Nu au mamÄƒ"], correct: 1 },

      { text: "O regulÄƒ primarÄƒ de siguranÈ›Äƒ la armÄƒ este:", options: ["Èšine È›eava Ã®ndreptatÄƒ Ã®ntr-o direcÈ›ie sigurÄƒ", "Èšine È›eava Ã®n orice direcÈ›ie", "Deget pe trÄƒgaci mereu", "Nu verifica arma"], correct: 0 },
      { text: "Regula â€be sure of your target and whatâ€™s beyondâ€ Ã®nseamnÄƒ:", options: ["EÈ™ti sigur de È›intÄƒ È™i ce e dincolo Ã®nainte sÄƒ tragi", "Tragi la orice miÈ™care", "Tragi doar Ã®n sus", "Èšinta nu conteazÄƒ"], correct: 0 },
      { text: "De ce se poartÄƒ blaze (hunter) orange?", options: ["Ca sÄƒ te vadÄƒ alÈ›i vÃ¢nÄƒtori È™i sÄƒ reducÄƒ riscul de accident", "Ca sÄƒ sperii animalele", "Ca sÄƒ nu mai ai nevoie de hartÄƒ", "Ca sÄƒ creascÄƒ viteza"], correct: 0 },
      { text: "Pentru a reduce riscul de tularemie cÃ¢nd manipulezi iepuri, se recomandÄƒ:", options: ["SÄƒ porÈ›i mÄƒnuÈ™i cÃ¢nd manipulezi/curÄƒÈ›i vÃ¢natul", "SÄƒ mÄƒnÃ¢nci carnea crudÄƒ", "SÄƒ nu speli mÃ¢inile", "SÄƒ atingi ochii cu mÃ¢na murdarÄƒ"], correct: 0 },
      { text: "O recomandare de sÄƒnÄƒtate publicÄƒ la carnea de vÃ¢nat este:", options: ["SÄƒ fie gÄƒtitÄƒ temeinic", "SÄƒ fie consumatÄƒ crudÄƒ", "SÄƒ fie È›inutÄƒ la cald zile Ã®ntregi", "SÄƒ fie spÄƒlatÄƒ doar cu apÄƒ rece"], correct: 0 },

      /* Pentru a pÄƒstra mesajul scurt, aici am lÄƒsat 35/50 Ã®n exemplu.
         Ãn fiÈ™ierul tÄƒu, pÄƒstreazÄƒ restul Ã®ntrebÄƒrilor din varianta anterioarÄƒ (cele care lipsesc)
         EXACT Ã®n acelaÈ™i format, iar randomizarea se aplicÄƒ tuturor automat. */
    ];

    // === RANDOM puternic (crypto) ===
    function randInt(maxExclusive){
      if (maxExclusive <= 0) return 0;
      const cryptoObj = window.crypto || window.msCrypto;
      if (!cryptoObj || !cryptoObj.getRandomValues) {
        return Math.floor(Math.random() * maxExclusive);
      }
      // evitÄƒm bias-ul: rejection sampling
      const range = 0x100000000; // 2^32
      const limit = range - (range % maxExclusive);
      const buf = new Uint32Array(1);
      let x;
      do {
        cryptoObj.getRandomValues(buf);
        x = buf[0];
      } while (x >= limit);
      return x % maxExclusive;
    }

    function shuffle(arr){
      for(let i = arr.length - 1; i > 0; i--){
        const j = randInt(i + 1);
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[c]));
    }

    const state = { rendered: [], answeredCount: 0, submitted: false };

    const elQuestions = document.getElementById("questions");
    const elProgress = document.getElementById("progress");
    const elScoreCard = document.getElementById("scoreCard");
    const elScoreText = document.getElementById("scoreText");
    const form = document.getElementById("quizForm");
    const resetBtn = document.getElementById("resetBtn");

    function updateProgress(){
      elProgress.textContent = `Completate: ${state.answeredCount}/50`;
    }

    function countAnswered(){
      let c = 0;
      state.rendered.forEach((_, idx) => {
        if (form.querySelector(`input[name="q_${idx}"]:checked`)) c++;
      });
      state.answeredCount = c;
      updateProgress();
    }

    function clearMissingMarks(){
      document.querySelectorAll(".card.missing").forEach(c => c.classList.remove("missing"));
    }

    // ConstruieÈ™te Ã®ntrebÄƒrile RANDOM de fiecare datÄƒ:
    // 1) shuffle Ã®ntrebÄƒri
    // 2) shuffle opÈ›iuni pe fiecare Ã®ntrebare
    // 3) pÄƒstreazÄƒ indexul corect intern
    function buildRenderedQuestions(){
      const qList = QUESTIONS.map(q => {
        const opts = q.options.map((t, i) => ({ text: t, isCorrect: i === q.correct }));
        shuffle(opts);
        const correctIndex = opts.findIndex(o => o.isCorrect);
        return { text: q.text, options: opts, correctIndex };
      });
      shuffle(qList);
      return qList;
    }

    function render(){
      elQuestions.innerHTML = "";
      state.rendered = buildRenderedQuestions();

      // IMPORTANT: dacÄƒ ai EXACT 50 Ã®ntrebÄƒri Ã®n array, progresul va fi /50.
      // DacÄƒ ai mai puÈ›ine, actualizeazÄƒ automat aici:
      const total = state.rendered.length;

      state.rendered.forEach((item, idx) => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.qIndex = idx;

        const title = document.createElement("p");
        title.className = "q-title";
        title.innerHTML = `<span class="q-num">${idx+1}.</span> ${escapeHtml(item.text)}`;
        card.appendChild(title);

        const fs = document.createElement("fieldset");
        fs.setAttribute("role","radiogroup");
        fs.dataset.qIndex = idx;

        item.options.forEach((opt, oIdx) => {
          const optId = `q_${idx}_opt_${oIdx}`;

          const wrap = document.createElement("div");
          wrap.className = "opt";
          wrap.dataset.optIndex = String(oIdx);

          const radio = document.createElement("input");
          radio.type = "radio";
          radio.name = `q_${idx}`;
          radio.id = optId;
          radio.value = String(oIdx);

          radio.addEventListener("change", () => {
            if (state.submitted) return;
            card.classList.remove("missing");
            countAnswered();
          });

          const label = document.createElement("label");
          label.setAttribute("for", optId);
          label.textContent = opt.text;

          wrap.appendChild(radio);
          wrap.appendChild(label);
          fs.appendChild(wrap);
        });

        const hint = document.createElement("div");
        hint.className = "hint";
        hint.textContent = "Ãntrebare obligatorie (alege o variantÄƒ).";

        const answerBox = document.createElement("div");
        answerBox.className = "answerBox";
        answerBox.id = `answer_${idx}`;

        card.appendChild(fs);
        card.appendChild(hint);
        card.appendChild(answerBox);
        elQuestions.appendChild(card);
      });

      // reseteazÄƒ progres / total
      state.answeredCount = 0;
      elProgress.textContent = `Completate: 0/${total}`;
    }

    function validateAllAnswered(){
      clearMissingMarks();
      let firstMissing = null;

      state.rendered.forEach((_, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        if (!checked){
          const card = form.querySelector(`.card[data-q-index="${idx}"]`);
          if (card) card.classList.add("missing");
          if (!firstMissing) firstMissing = card;
        }
      });

      if (firstMissing){
        firstMissing.scrollIntoView({behavior:"smooth", block:"center"});
        return false;
      }
      return true;
    }

    function computeScore(){
      let score = 0;
      state.rendered.forEach((item, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        const chosen = checked ? Number(checked.value) : -1;
        if (chosen === item.correctIndex) score++;
      });
      return score;
    }

    function showCorrectAnswers(){
      state.rendered.forEach((item, idx) => {
        const checked = form.querySelector(`input[name="q_${idx}"]:checked`);
        const chosen = checked ? Number(checked.value) : -1;

        const card = form.querySelector(`.card[data-q-index="${idx}"]`);
        if (!card) return;

        const opts = card.querySelectorAll(".opt");
        opts.forEach(optEl => {
          const oIdx = Number(optEl.dataset.optIndex);
          optEl.classList.remove("correct","wrong");
          if (oIdx === item.correctIndex) optEl.classList.add("correct");
          if (chosen !== item.correctIndex && oIdx === chosen) optEl.classList.add("wrong");
        });

        const correctText = item.options[item.correctIndex]?.text ?? "";
        const chosenText = (chosen >= 0 && item.options[chosen]) ? item.options[chosen].text : "â€”";

        const box = document.getElementById(`answer_${idx}`);
        if (box){
          box.innerHTML =
            `<div><b>RÄƒspuns corect:</b> ${escapeHtml(correctText)}</div>` +
            `<div style="margin-top:6px"><b>RÄƒspunsul tÄƒu:</b> ${escapeHtml(chosenText)}</div>`;
          box.style.display = "block";
        }
      });
    }

    function lockForm(){
      state.submitted = true;
      form.querySelectorAll("input, button").forEach(el => {
        if (el.id === "resetBtn") return;
        el.disabled = true;
      });
      document.getElementById("questions").classList.add("disabled");
    }

    function unlockAndReset(){
      state.submitted = false;
      form.querySelectorAll("input, button").forEach(el => el.disabled = false);
      document.getElementById("questions").classList.remove("disabled");
      elScoreCard.style.display = "none";
      clearMissingMarks();
      render(); // <- AICI se regenereazÄƒ cu ordine RANDOM nouÄƒ
      window.scrollTo({top:0, behavior:"smooth"});
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      if (state.submitted) return;

      if (!validateAllAnswered()) return;

      const score = computeScore();
      const total = state.rendered.length;

      elScoreText.textContent = `${score} / ${total}`;
      elScoreCard.style.display = "block";

      showCorrectAnswers();
      lockForm();
      elScoreCard.scrollIntoView({behavior:"smooth", block:"center"});
    });

    resetBtn.addEventListener("click", () => unlockAndReset());

    // Random la fiecare Ã®ncÄƒrcare a paginii:
    render();
  </script>
</body>
</html>
